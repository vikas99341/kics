<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://www.kics.io/queries/kubernetes-queries/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Kubernetes - KICS</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <link href="../../css/custom.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-186818347-2', 'auto');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">KICS</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../getting-started/" class="dropdown-item">Installation</a>
</li>
                                    
<li>
    <a href="../../configuration-file/" class="dropdown-item">Configuration</a>
</li>
                                    
<li>
    <a href="../../results/" class="dropdown-item">Results</a>
</li>
                                    
<li>
    <a href="../../architecture/" class="dropdown-item">Architecture</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Usage</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../usage/commands/" class="dropdown-item">KICS Commands</a>
</li>
            
<li>
    <a href="../../usage/technologies/" class="dropdown-item">Techonologies</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Queries <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">General Info</a>
</li>
                                    
<li>
    <a href="../../creating-queries/" class="dropdown-item">Creating Queries</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Queries List</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../all-queries/" class="dropdown-item">All</a>
</li>
            
<li>
    <a href="../ansible-queries/" class="dropdown-item">Ansible</a>
</li>
            
<li>
    <a href="../cloudformation-queries/" class="dropdown-item">CloudFormation</a>
</li>
            
<li>
    <a href="../common-queries/" class="dropdown-item">Common</a>
</li>
            
<li>
    <a href="../dockerfile-queries/" class="dropdown-item">Dockerfile</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Kubernetes</a>
</li>
            
<li>
    <a href="../terraform-queries/" class="dropdown-item">Terraform</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Integrations <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../integrations/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../integrations_ghactions/" class="dropdown-item">Github Actions</a>
</li>
                                    
<li>
    <a href="../../integrations_gitlabci/" class="dropdown-item">Gitlab CI</a>
</li>
                                    
<li>
    <a href="../../integrations_azurepipelines/" class="dropdown-item">Azure DevOps</a>
</li>
                                    
<li>
    <a href="../../integrations_bitbucketpipelines/" class="dropdown-item">Bitbucket Pipelines</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Project <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../roadmap/" class="dropdown-item">Roadmap</a>
</li>
                                    
<li>
    <a href="https://github.com/Checkmarx/kics/projects" class="dropdown-item">Plans</a>
</li>
                                    
<li>
    <a href="https://github.com/Checkmarx/kics/issues" class="dropdown-item">Issues</a>
</li>
                                    
<li>
    <a href="../../releases/" class="dropdown-item">Releases</a>
</li>
                                    
<li>
    <a href="../../benchmark/" class="dropdown-item">Benchmark</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../CONTRIBUTING/" class="nav-link">Contribution</a>
                            </li>
                            <li class="navitem">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../dockerfile-queries/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../terraform-queries/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/Checkmarx/kics/edit/master/docs/queries/kubernetes-queries.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#kubernetes-queries-list" class="nav-link">Kubernetes Queries List</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h2 id="kubernetes-queries-list">Kubernetes Queries List</h2>
<p>This page contains all queries from Kubernetes.</p>
<table>
<thead>
<tr>
<th>Query</th>
<th>Severity</th>
<th>Category</th>
<th>Description</th>
<th>Help</th>
</tr>
</thead>
<tbody>
<tr>
<td>Privilege Escalation Allowed<br/><sup><sub>5572cc5e-1e4c-4113-92a6-7a8a3bd25e6d</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Containers should not run with allowPrivilegeEscalation in order to prevent them from gaining more privileges than their parent process</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Documentation</a><br/></td>
</tr>
<tr>
<td>Tiller (Helm v2) Is Deployed<br/><sup><sub>6d173be7-545a-46c6-a81d-2ae52ed1605d</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Check if Tiller is deployed.</td>
<td><a href="https://kubernetes.io/docs/concepts/containers/images/">Documentation</a><br/></td>
</tr>
<tr>
<td>Cluster Allows Unsafe Sysctls<br/><sup><sub>9127f0d9-2310-42e7-866f-5fd9d20dcbad</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>A Kubernetes Cluster must not allow unsafe sysctls, to prevent a pod from having any influence on any other pod on the node, harming the node's health or gaining CPU or memory resources outside of the resource limits of a pod. This means the 'spec.securityContext.sysctls' must not have an unsafe sysctls and that the atrribute 'allowedUnsafeSysctls' must be undefined.</td>
<td><a href="https://kubernetes.io/docs/tasks/administer-cluster/sysctl-cluster/">Documentation</a><br/></td>
</tr>
<tr>
<td>Host Aliases Undefined Or Empty<br/><sup><sub>72b03514-20ae-4409-8842-2dd70c2e25aa</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>A Pod should have Host Aliases defined as to prevent the container from modifying the file after a pod's containers have already been started. This means the attribute 'spec.hostAliases' must be defined and not empty or null.</td>
<td><a href="https://kubernetes.io/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/">Documentation</a><br/></td>
</tr>
<tr>
<td>Tiller Service Is Not Deleted<br/><sup><sub>8b862ca9-0fbd-4959-ad72-b6609bdaa22d</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Check if there is any Tiller Service present</td>
<td><a href="https://kubernetes.io/docs/concepts/services-networking/service">Documentation</a><br/></td>
</tr>
<tr>
<td>Shared Host IPC Namespace<br/><sup><sub>cd290efd-6c82-4e9d-a698-be12ae31d536</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Container should not share the host IPC namespace</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>Container Is Privileged<br/><sup><sub>dd29336b-fe57-445b-a26e-e6aa867ae609</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Do not allow container to be privileged.</td>
<td><a href="https://kubernetes.io/docs/concepts/workloads/pods/#privileged-mode-for-containers">Documentation</a><br/></td>
</tr>
<tr>
<td>NET_RAW Capabilities Not Being Dropped<br/><sup><sub>dbbc6705-d541-43b0-b166-dd4be8208b54</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Containers should drop 'NET_RAW' or 'ALL' capabilities</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Documentation</a><br/></td>
</tr>
<tr>
<td>Object Is Using A Deprecated API Version<br/><sup><sub>94b76ea5-e074-4ca2-8a03-c5a606e30645</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Check if any objects are using a deprecated version of API.</td>
<td><a href="https://kubernetes.io/docs/reference/using-api/deprecation-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>Not Limited Capabilities For Pod Security Policy<br/><sup><sub>caa93370-791f-4fc6-814b-ba6ce0cb4032</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Limit capabilities for a Pod Security Policy</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>Shared Host PID Namespace<br/><sup><sub>302736f4-b16c-41b8-befe-c0baffa0bd9d</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Container should not share the host process ID namespace</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>PSP Allows Containers To Share The Host Network Namespace<br/><sup><sub>a33e9173-b674-4dfb-9d82-cf3754816e4b</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Check if Pod Security Policies allow containers to share the host network namespace.</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>Shared Host Network Namespace<br/><sup><sub>6b6bdfb3-c3ae-44cb-88e4-7405c1ba2c8a</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Container should not share the host network namespace</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>Role Binding To Default Service Account<br/><sup><sub>1e749bc9-fde8-471c-af0c-8254efd2dee5</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Defaults</td>
<td>No role nor cluster role should bind to a default service account</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">Documentation</a><br/></td>
</tr>
<tr>
<td>Tiller Deployment Is Accessible From Within The Cluster<br/><sup><sub>e17fa86a-6222-4584-a914-56e8f6c87e06</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Networking and Firewall</td>
<td>Check if any Tiller Deployment container allows access from within the cluster.</td>
<td><a href="https://kubernetes.io/docs/concepts/containers/images/">Documentation</a><br/></td>
</tr>
<tr>
<td>Non Kube System Pod With Host Mount<br/><sup><sub>aa8f7a35-9923-4cad-bd61-a19b7f6aac91</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Access Control</td>
<td>A non kube-system workload should not have hostPath mounted</td>
<td><a href="https://kubernetes.io/docs/concepts/storage/volumes/">Documentation</a><br/></td>
</tr>
<tr>
<td>RBAC Roles with Read Secrets Permissions<br/><sup><sub>b7bca5c4-1dab-4c2c-8cbe-3050b9d59b14</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Access Control</td>
<td>Minimize access to secrets (RBAC)</td>
<td><a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">Documentation</a><br/></td>
</tr>
<tr>
<td>Liveness Probe Is Not Defined<br/><sup><sub>ade74944-a674-4e00-859e-c6eab5bde441</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Availability</td>
<td>Liveness Probe must be defined.</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#define-a-tcp-liveness-probe">Documentation</a><br/></td>
</tr>
<tr>
<td>Readiness Probe Is Not Configured<br/><sup><sub>a659f3b5-9bf0-438a-bd9a-7d3a6427f1e3</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Availability</td>
<td>Check if Readiness Probe is not configured.</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#define-readiness-probes">Documentation</a><br/></td>
</tr>
<tr>
<td>Container Running With Low UID<br/><sup><sub>02323c00-cdc3-4fdc-a310-4f2b3e7a1660</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Best Practices</td>
<td>Check if containers are running with low UID, which might cause conflicts with the host's user table.</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Documentation</a><br/></td>
</tr>
<tr>
<td>Resource With Allow Privilege Escalation<br/><sup><sub>0a7c420c-4568-4cec-ba36-4d42a6f9613b</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Best Practices</td>
<td>Minimize the admission of privileged resources</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>Root Containers Admitted<br/><sup><sub>e3aa0612-4351-4a0d-983f-aefea25cf203</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Best Practices</td>
<td>Containers must not be allowed to run with root privileges, which means the attributes 'privileged','allowPrivilegeEscalation' and 'readOnlyRootFilesystem' must be set to false, 'runAsUser.rule' must be set to 'MustRunAsNonRoot', and adding the root group must be forbidden</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>Container Running As Root<br/><sup><sub>cf34805e-3872-4c08-bf92-6ff7bb0cfadb</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Best Practices</td>
<td>Check if containers are running as root unduly.</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Documentation</a><br/></td>
</tr>
<tr>
<td>Incorrect Volume Claim Access Mode ReadWriteOnce<br/><sup><sub>3878dc92-8e5d-47cf-9cdd-7590f71d21b9</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Build Process</td>
<td>Stateful Sets must have one Volume Claim template with the access mode 'ReadWriteOnce'</td>
<td><a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/">Documentation</a><br/></td>
</tr>
<tr>
<td>Ingress Controller Exposes Workload<br/><sup><sub>69bbc5e3-0818-4150-89cc-1e989b48f23b</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Ingress Controllers should not expose workload in order to avoid vulnerabilities and DoS attacks</td>
<td><a href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/">Documentation</a><br/></td>
</tr>
<tr>
<td>PSP Allows Sharing Host PID<br/><sup><sub>91dacd0e-d189-4a9c-8272-5999a3cc32d9</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Pod Security Policy allows containers to share the host process ID namespace</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>NET_RAW Capabilities Disabled for PSP<br/><sup><sub>2270987f-bb51-479f-b8be-3ca73e5ad648</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Containers need to have NET_RAW or All as drop capabilities</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>PSP With Added Capabilities<br/><sup><sub>7307579a-3abb-46ad-9ce5-2a915634d5c8</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>PodSecurityPolicy should not have added capabilities</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>Using Default Namespace<br/><sup><sub>611ab018-c4aa-4ba2-b0f6-a448337509a6</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>The default namespace should not be used</td>
<td><a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/">Documentation</a><br/></td>
</tr>
<tr>
<td>Default Service Account In Use<br/><sup><sub>b93e973e-9066-4455-a63b-c1c0e1ec3a48</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Default service accounts should not be actively used</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">Documentation</a><br/></td>
</tr>
<tr>
<td>Seccomp Profile Is Not Configured<br/><sup><sub>f377b83e-bd07-4f48-a591-60c82b14a78b</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Check if any resource does not configure Seccomp default profile properly</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/#seccomp">Documentation</a><br/></td>
</tr>
<tr>
<td>PSP Set To Privileged<br/><sup><sub>c48e57d3-d642-4e0b-90db-37f807b41b91</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Do not allow pod to request execution as privileged.</td>
<td><a href="https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod_security_policy#privileged">Documentation</a><br/></td>
</tr>
<tr>
<td>PSP Allows Sharing Host IPC<br/><sup><sub>80f93444-b240-4ebb-a4c6-5c40b76c04ea</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Pod Security Policy allows containers to share the host IPC namespace</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>PSP Allows Privilege Escalation<br/><sup><sub>87554eef-154d-411d-bdce-9dbd91e56851</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>PodSecurityPolicy should not allow privilege escalation</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>Not Limited Capabilities For Container<br/><sup><sub>2f1a0619-b12b-48a0-825f-993bb6f01d58</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Limit the capabilities for a Container.</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Documentation</a><br/></td>
</tr>
<tr>
<td>Containers With Sys Admin Capabilities<br/><sup><sub>235236ee-ad78-4065-bd29-61b061f28ce0</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Containers should not have CAP_SYS_ADMIN Linux capability</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Documentation</a><br/></td>
</tr>
<tr>
<td>Container Runs Unmasked<br/><sup><sub>f922827f-aab6-447c-832a-e1ff63312bd3</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Check if a container has full access (unmasked) to the host’s /proc command, which would allow to retrieve sensitive information and possibly change the kernel parameters in runtime.</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/#allowedprocmounttypes">Documentation</a><br/></td>
</tr>
<tr>
<td>Containers With Added Capabilities<br/><sup><sub>19ebaa28-fc86-4a58-bcfa-015c9e22fe40</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Containers should not have added capability</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Documentation</a><br/></td>
</tr>
<tr>
<td>Workload Mounting With Sensitive OS Directory<br/><sup><sub>5308a7a8-06f8-45ac-bf10-791fe21de46e</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Configurations</td>
<td>Workload is mounting a volume with sensitive OS Directory</td>
<td><a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">Documentation</a><br/></td>
</tr>
<tr>
<td>Service Account Name Undefined Or Empty<br/><sup><sub>591ade62-d6b0-4580-b1ae-209f80ba1cd9</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Defaults</td>
<td>A Pod should have a Service Account defined so to restrict Kubernetes API access, which means the attribute 'serviceAccountName' should be defined and not empty.</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">Documentation</a><br/></td>
</tr>
<tr>
<td>Service Account Token Automount Not Disabled<br/><sup><sub>48471392-d4d0-47c0-b135-cdec95eb3eef</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Defaults</td>
<td>Service Account Tokens are automatically mounted even if not necessary</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#use-the-default-service-account-to-access-the-api-server">Documentation</a><br/></td>
</tr>
<tr>
<td>Network Policy Is Not Targeting Any Pod<br/><sup><sub>85ab1c5b-014e-4352-b5f8-d7dea3bb4fd3</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Networking and Firewall</td>
<td>Check if any network policy is not targeting any pod.</td>
<td><a href="https://kubernetes.io/docs/concepts/services-networking/network-policies/">Documentation</a><br/></td>
</tr>
<tr>
<td>Service With External Load Balance<br/><sup><sub>26763a1c-5dda-4772-b507-5fca7fb5f165</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Networking and Firewall</td>
<td>Service has an external load balancer, which may cause accessibility from other networks and the Internet</td>
<td><a href="https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/">Documentation</a><br/></td>
</tr>
<tr>
<td>Pod Misconfigured Network Policy<br/><sup><sub>0401f71b-9c1e-4821-ab15-a955caa621be</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Networking and Firewall</td>
<td>Check if any pod is not being targeted by a proper network policy.</td>
<td><a href="https://kubernetes.io/docs/concepts/services-networking/network-policies/">Documentation</a><br/></td>
</tr>
<tr>
<td>Volume Mount With OS Directory Write Permissions<br/><sup><sub>b7652612-de4e-4466-a0bf-1cd81f0c6063</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Resource Management</td>
<td>Containers can mount sensitive folders from the hosts, giving them potentially dangerous access to critical host configurations and binaries.</td>
<td><a href="https://kubernetes.io/docs/concepts/storage/volumes/">Documentation</a><br/></td>
</tr>
<tr>
<td>CPU Limits Not Set<br/><sup><sub>4ac0e2b7-d2d2-4af7-8799-e8de6721ccda</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Resource Management</td>
<td>CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests</td>
<td><a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">Documentation</a><br/></td>
</tr>
<tr>
<td>CPU Requests Not Set<br/><sup><sub>ca469dd4-c736-448f-8ac1-30a642705e0a</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Resource Management</td>
<td>CPU requests should be set to ensure the sum of the resource requests of the scheduled Containers is less than the capacity of the node</td>
<td><a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#">Documentation</a><br/></td>
</tr>
<tr>
<td>Memory Limits Not Defined<br/><sup><sub>b14d1bc4-a208-45db-92f0-e21f8e2588e9</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Resource Management</td>
<td>Memory limits should be specified</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/">Documentation</a><br/></td>
</tr>
<tr>
<td>Memory Requests Not Defined<br/><sup><sub>229588ef-8fde-40c8-8756-f4f2b5825ded</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Resource Management</td>
<td>Memory requests should be specified</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/">Documentation</a><br/></td>
</tr>
<tr>
<td>Shared Service Account<br/><sup><sub>c1032cf7-3628-44e2-bd53-38c17cf31b6b</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Secret Management</td>
<td>A Service Account token is shared between workloads</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">Documentation</a><br/></td>
</tr>
<tr>
<td>ServiceAccount Allows Access Secrets<br/><sup><sub>056ac60e-fe07-4acc-9b34-8e1d51716ab9</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Secret Management</td>
<td>Roles and ClusterRoles when binded, should not use get, list or watch as verbs</td>
<td><a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">Documentation</a><br/></td>
</tr>
<tr>
<td>Docker Daemon Socket is Exposed to Containers<br/><sup><sub>a6f34658-fdfb-4154-9536-56d516f65828</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Access Control</td>
<td>Sees if Docker Daemon Socket is not exposed to Containers</td>
<td><a href="https://kubernetes.io/docs/concepts/storage/volumes/">Documentation</a><br/></td>
</tr>
<tr>
<td>Cluster Admin Rolebinding With Superuser Permissions<br/><sup><sub>249328b8-5f0f-409f-b1dd-029f07882e11</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Access Control</td>
<td>Ensure that the cluster-admin role is only used where required (RBAC)</td>
<td><a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/#user-facing-roles">Documentation</a><br/></td>
</tr>
<tr>
<td>Permissive Access to Create Pods<br/><sup><sub>592ad21d-ad9b-46c6-8d2d-fad09d62a942</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Access Control</td>
<td>The permission to create pods in a cluster should be restricted because it allows privilege escalation.</td>
<td><a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/#privilege-escalation-prevention-and-bootstrapping">Documentation</a><br/></td>
</tr>
<tr>
<td>Missing App Armor Config<br/><sup><sub>8b36775e-183d-4d46-b0f7-96a6f34a723f</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Access Control</td>
<td>Containers should be configured with AppArmor for any application to reduce its potential attack</td>
<td><a href="https://kubernetes.io/docs/tutorials/clusters/apparmor/">Documentation</a><br/></td>
</tr>
<tr>
<td>RBAC Wildcard In Rule<br/><sup><sub>6b896afb-ca07-467a-b256-1a0077a1c08e</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Access Control</td>
<td>Kubernetes Roles and ClusterRoles should not use wildcards in rules (objects or actions)</td>
<td><a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">Documentation</a><br/></td>
</tr>
<tr>
<td>HPA Targeted Deployments With Configured Replica Count<br/><sup><sub>5744cbb8-5946-4b75-a196-ade44449525b</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Availability</td>
<td>Deployments targeted by HorizontalPodAutoscaler should not have a statically configured replica count set</td>
<td><a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/">Documentation</a><br/></td>
</tr>
<tr>
<td>StatefulSet Without PodDisruptionBudget<br/><sup><sub>1db3a5a5-bf75-44e5-9e44-c56cfc8b1ac5</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Availability</td>
<td>StatefulSets should be assigned with a PodDisruptionBudget to ensure high availability</td>
<td><a href="https://kubernetes.io/docs/tasks/run-application/configure-pdb/">Documentation</a><br/></td>
</tr>
<tr>
<td>StatefulSet Without Service Name<br/><sup><sub>bb241e61-77c3-4b97-9575-c0f8a1e008d0</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Availability</td>
<td>Check if the StatefulSets have a headless 'serviceName'</td>
<td><a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/">Documentation</a><br/></td>
</tr>
<tr>
<td>Deployment Without PodDisruptionBudget<br/><sup><sub>b23e9b98-0cb6-4fc9-b257-1f3270442678</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Availability</td>
<td>Deployments should be assigned with a PodDisruptionBudget to ensure high availability</td>
<td><a href="https://kubernetes.io/docs/tasks/run-application/configure-pdb/">Documentation</a><br/></td>
</tr>
<tr>
<td>HPA Targets Invalid Object<br/><sup><sub>2f652c42-619d-4361-b361-9f599688f8ca</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Availability</td>
<td>The Horizontal Pod Autoscale must target a valid object</td>
<td><a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/">Documentation</a><br/></td>
</tr>
<tr>
<td>No Drop Capabilities for Containers<br/><sup><sub>268ca686-7fb7-4ae9-b129-955a2a89064e</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Best Practices</td>
<td>Sees if Kubernetes Drop Capabilities exists to ensure containers security context</td>
<td><a href="https://kubernetes.io/docs/concepts/workloads/pods/init-containers/">Documentation</a><br/></td>
</tr>
<tr>
<td>Metadata Label Is Invalid<br/><sup><sub>1123031a-f921-4c5b-bd86-ef354ecfd37a</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Best Practices</td>
<td>Check if any label in the metadata is invalid.</td>
<td><a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/">Documentation</a><br/></td>
</tr>
<tr>
<td>Root Container Not Mounted As Read-only<br/><sup><sub>a9c2f49d-0671-4fc9-9ece-f4e261e128d0</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Build Process</td>
<td>Check if the root container filesystem is not being mounted as read-only.</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Documentation</a><br/></td>
</tr>
<tr>
<td>StatefulSet Requests Storage<br/><sup><sub>8cf4671a-cf3d-46fc-8389-21e7405063a2</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Build Process</td>
<td>A StatefulSet requests volume storage.</td>
<td><a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/">Documentation</a><br/></td>
</tr>
<tr>
<td>Image Pull Policy Of The Container Is Not Set To Always<br/><sup><sub>caa3479d-885d-4882-9aac-95e5e78ef5c2</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Insecure Configurations</td>
<td>Image Pull Policy of the container must be defined and set to Always</td>
<td><a href="https://kubernetes.io/docs/concepts/containers/images/#updating-images">Documentation</a><br/></td>
</tr>
<tr>
<td>Dashboard Is Enabled<br/><sup><sub>d2ad057f-0928-41ef-a83c-f59203bb855b</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Insecure Configurations</td>
<td>If not needed, disabling the dashboard can prevent from being used as an attack vector</td>
<td><a href="https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/">Documentation</a><br/></td>
</tr>
<tr>
<td>Pod or Container Without Security Context<br/><sup><sub>a97a340a-0063-418e-b3a1-3028941d0995</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Insecure Configurations</td>
<td>A security context defines privilege and access control settings for a Pod or Container</td>
<td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Documentation</a><br/></td>
</tr>
<tr>
<td>Image Without Digest<br/><sup><sub>7c81d34c-8e5a-402b-9798-9f442630e678</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Insecure Configurations</td>
<td>Sees if Kubernetes image has digest on</td>
<td><a href="https://kubernetes.io/docs/concepts/containers/images/#updating-images">Documentation</a><br/></td>
</tr>
<tr>
<td>Service Does Not Target Pod<br/><sup><sub>3ca03a61-3249-4c16-8427-6f8e47dda729</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Insecure Configurations</td>
<td>Service should Target a Pod</td>
<td><a href="https://kubernetes.io/docs/concepts/services-networking/service/">Documentation</a><br/></td>
</tr>
<tr>
<td>Workload Host Port Not Specified<br/><sup><sub>2b1836f1-dcce-416e-8e16-da8c71920633</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Networking and Firewall</td>
<td>Verifies if Kubernetes workload's host port is specified</td>
<td><a href="https://kubernetes.io/docs/concepts/services-networking/connect-applications-service/#exposing-the-service">Documentation</a><br/></td>
</tr>
<tr>
<td>Service Type is NodePort<br/><sup><sub>845acfbe-3e10-4b8e-b656-3b404d36dfb2</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Networking and Firewall</td>
<td>Service type should not be NodePort</td>
<td><a href="https://kubernetes.io/docs/concepts/services-networking/service/">Documentation</a><br/></td>
</tr>
<tr>
<td>Container CPU Requests Not Equal To It's Limits<br/><sup><sub>9d43040e-e703-4e16-8bfe-8d4da10fa7e6</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Resource Management</td>
<td>A Pod's Containers must have the same CPU requests as limits set, which is recommended to avoid resource DDOS of the node during spikes. This means the 'requests.cpu' must equal 'limits.cpu', and both be defined.</td>
<td><a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">Documentation</a><br/></td>
</tr>
<tr>
<td>StatefulSet Has No PodAntiAffinity<br/><sup><sub>d740d048-8ed3-49d3-b77b-6f072f3b669e</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Resource Management</td>
<td>Check if StatefulSet resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node.</td>
<td><a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/">Documentation</a><br/></td>
</tr>
<tr>
<td>CronJob Deadline Not Configured<br/><sup><sub>192fe40b-b1c3-448a-aba2-6cc19a300fe3</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Resource Management</td>
<td>Cronjobs must have a configured deadline, which means the attribute 'startingDeadlineSeconds' must be defined</td>
<td><a href="https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/">Documentation</a><br/></td>
</tr>
<tr>
<td>Deployment Has No PodAntiAffinity<br/><sup><sub>a31b7b82-d994-48c4-bd21-3bab6c31827a</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Resource Management</td>
<td>Check if Deployment resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node.</td>
<td><a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/">Documentation</a><br/></td>
</tr>
<tr>
<td>Container Requests Not Equal To It's Limits<br/><sup><sub>aee3c7d2-a811-4201-90c7-11c028be9a46</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Resource Management</td>
<td>A Pod's Containers must have the same requests as limits set, which is recommended to avoid resource DDOS of the node during spikes. This means the 'requests.memory' and 'requests.cpu' must equal 'limits.memory' and 'limits.cpu', respectively, and all four must be defined.</td>
<td><a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">Documentation</a><br/></td>
</tr>
<tr>
<td>Container Memory Requests Not Equal To It's Limits<br/><sup><sub>aafa7d94-62de-4fbf-8838-b69ee217b0e6</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Resource Management</td>
<td>A Pod's Containers must have the same Memory requests as limits set, which is recommended to avoid resource DDOS of the node during spikes. This means the 'requests.memory' must equal 'limits.memory', and both be defined.</td>
<td><a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">Documentation</a><br/></td>
</tr>
<tr>
<td>Secrets As Environment Variables<br/><sup><sub>3d658f8b-d988-41a0-a841-40043121de1e</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Secret Management</td>
<td>Container should not use secrets as environment variables</td>
<td><a href="https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets-as-environment-variables">Documentation</a><br/></td>
</tr>
<tr>
<td>Invalid Image<br/><sup><sub>583053b7-e632-46f0-b989-f81ff8045385</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Supply-Chain</td>
<td>Image must be defined and not be empty or equal to latest.</td>
<td><a href="https://kubernetes.io/docs/concepts/containers/images/#updating-images">Documentation</a><br/></td>
</tr>
</tbody>
</table></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>&copy; 2021 Checkmarx Ltd. All Rights Reserved.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../js/custom.js" defer></script>
        <script src="../../js/version-mike.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
